<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:ops="http://www.idpf.org/2007/ops" xml:lang="en" class="translated-ltr" style="height: 100%;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <link rel="stylesheet" type="text/css" href="./Chapter 2 _ Limit sets of Kleinian groups_files/style.scss">
  <meta name="generator" content="Re:VIEW">
  <title>Limit sets of Kleinian groups</title>

			<style>
				img {
					max-width: 80vw;
					max-height: 80vh;
				}
			</style><style>
					.goog-te-banner-frame {
						display: none;
					}
				</style>
			<script>(function(){(function injection() {
  var pageLang = 'ja';
  var userLang = 'en';

  var uid = '1E07F158C6FA4460B352973E9693B329';
  var teId = 'TE_' + uid;
  var cbId = 'TECB_' + uid;

  function show() {
    window.setTimeout(function() {
      window[teId].showBanner(true);
    }, 10);
  }

  function newElem() {
    
  }

  if (window[teId]) {
    show();
  } else {
    if (!window.google || !google.translate ||
        !google.translate.TranslateElement) {
      if (!window[cbId]) {
        window[cbId] = function() {
          window[teId] = newElem();
          show();
        };
      }
      
    }
  }
})();})();</script><script src="https://translate.google.com/translate_a/element.js?cb=TECB_1E07F158C6FA4460B352973E9693B329&amp;client=tee&amp;hl=en"></script><script src="./Chapter 2 _ Limit sets of Kleinian groups_files/f.txt"></script><link type="text/css" rel="stylesheet" charset="UTF-8" href="https://translate.googleapis.com/translate_static/css/translateelement.css"><script type="text/javascript" charset="UTF-8" src="https://translate.googleapis.com/translate_static/js/element/main.js"></script><link type="text/css" rel="stylesheet" charset="UTF-8" href="./Chapter 2 _ Limit sets of Kleinian groups_files/translateelement.css"><script type="text/javascript" charset="UTF-8" src="./Chapter 2 _ Limit sets of Kleinian groups_files/main.js"></script><script type="text/javascript" charset="UTF-8" src="https://translate.googleapis.com/element/TE_20201130_00/e/js/element/element_main.js"></script><script type="text/javascript" charset="UTF-8" src="./Chapter 2 _ Limit sets of Kleinian groups_files/element_main.js"></script><script type="text/javascript" charset="UTF-8" src="https://translate.googleapis.com/element/TE_20201130_00/e/js/element/element_main.js"></script><link type="text/css" rel="stylesheet" charset="UTF-8" href="https://translate.googleapis.com/translate_static/css/translateelement.css"><script type="text/javascript" charset="UTF-8" src="https://translate.googleapis.com/translate_static/js/element/main.js"></script><script type="text/javascript" charset="UTF-8" src="https://translate.googleapis.com/element/TE_20201130_00/e/js/element/element_main.js"></script></head>
		
<body style="position: relative; min-height: 100%; top: 40px;"><div class="skiptranslate" style=""><iframe id=":0.container" class="goog-te-banner-frame skiptranslate" frameborder="0" src="javascript:''" style="visibility:visible"></iframe></div><div class="skiptranslate" style=""><iframe id=":0.container" class="goog-te-banner-frame skiptranslate" frameborder="0" src="javascript:''" style="visibility:visible"></iframe></div><div class="skiptranslate" style=""><iframe id=":0.container" class="goog-te-banner-frame skiptranslate" frameborder="0" src="javascript:''" style="visibility:visible"></iframe></div>
<h1><a id="h2"></a><span class="secno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;" class="">Chapter 2　</font></font></span><font style="vertical-align: inherit;"><font class="" style="vertical-align: inherit;"> Limit sets of Kleinian groups</font></font></h1>
<div id="id_fuqunaga_2Fintro0" class="image">
<img src="./Chapter 2 _ Limit sets of Kleinian groups_files/intro0.png" alt="">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 2.1: 
</font></font></p>
</div>
<div id="id_fuqunaga_2Fintro2" class="image">
<img src="./Chapter 2 _ Limit sets of Kleinian groups_files/intro2.png" alt="">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 2.2: 
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this chapter, we will introduce how to draw the limit set of Kleinian groups with a shader and animate the resulting fractal figure. </font><font style="vertical-align: inherit;">Speaking of fractal animation, it is interesting to see a self-similar figure by scaling it up or down, but with this method, you can see a characteristic movement in which straight lines and circumferences transition more smoothly.</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The sample in this chapter is </font><font style="vertical-align: inherit;">"Kleinian Group" of </font></font><br><a href="https://github.com/IndieVisualLab/UnityGraphicsProgramming4" class="link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/IndieVisualLab/UnityGraphicsProgramming4</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p>

<h2><a id="h2-1"></a><span class="secno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.1　</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Yen reversal</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">First, I will introduce the inversion of figures. </font><font style="vertical-align: inherit;">I think it is familiar that a figure that is inverted like a mirror image with a straight line as a boundary is line-symmetrical, and if it is inverted around a point, it is point-symmetrical. </font><font style="vertical-align: inherit;">There is also a reversal of circles. </font><font style="vertical-align: inherit;">It is an operation to switch the inside and outside of the circle on the two-dimensional plane.</font></font></p>
<div id="id_fuqunaga_2Fcircle__inverse0" class="image">
<img src="./Chapter 2 _ Limit sets of Kleinian groups_files/circle_inverse0.png" alt="円反転<span class=&quot;equation&quot;>P \rightarrow P'</span>" class="width-050per">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 2.3: Circle Inversion </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P \ rightarrow P'</font></font></span>
</p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The center of the circle </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , radius </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> inverted with respect to the circle of, </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\ Left | OP \ Right |</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">| '\ right | \ left OP</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is so as to satisfy the following equation remains the same direction </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P'</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to move to the operation Become.</font></font></p>
<div class="equation">
<pre>\left| OP\right| \cdot \left| OP'\right| =r^{2}
</pre>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the vicinity of the circumference, the inside and outside appear to be interchanged like a distorted line symmetry, and the infinity far away from the circumference and the center of the circle are interchanged. </font><font style="vertical-align: inherit;">What is interesting is the case where the straight line on the outside of the circle is inverted, and when it is close to the circle, it moves to the inside across the circumference and continues to infinity as it moves away from it. Become.</font></font></p>
<div id="id_fuqunaga_2Fcircle__inverse1" class="image">
<img src="./Chapter 2 _ Limit sets of Kleinian groups_files/circle_inverse1.png" alt="Straight line inversion" class="width-070per">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 2.4: Straight line inversion
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It will appear as a small circle inside the circle. </font><font style="vertical-align: inherit;">If you think of a straight line as a circle with an infinite radius, you can say that circle inversion is an operation that swaps the circles inside and outside the circle.</font></font></p>

<h3><a id="h2-1-1"></a><span class="secno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.1.1 Expressed by　</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mathematical formula</font></font></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The formula for the circle inversion of the unit circle on the complex plane is as follows.</font></font></p>
<div class="equation">
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z \ rightarrow \ dfrac {1} {\ overline {z}}
</font></font></font></font></pre>
</div>
<p><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is a complex number and </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">\ overline {z}</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is its complex common benefit.</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The next way and try to formula deformation </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1 divided by the square power of the length of the </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> you can see that is an operation that is scale.</font></font></p>
<div class="equation">
<pre>z\rightarrow \dfrac {1}{\overline {z}}=\dfrac {1}{x-iy}=\dfrac {x+iy}{\left( x-iy\right) \left( x+iy\right) }=\dfrac {x+iy}{x^{2}+y^{2}}=\dfrac {z}{\left| z\right| ^{2}}
</pre>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a graphic operation on the complex plane,</font></font></p>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sum of complex numbers: translation</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Complex product: rotation (and scaling)</font></font></li>
</ul>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I think that many people are aware that, but this is where operations including division are newly added.</font></font></p>

<h2><a id="h2-2"></a><span class="secno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.2　</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mobius transformation</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Mobius transformation </font></font><a id="fnb-mebius" href="https://freder.io/files/unity4/fuqunaga.html#fn-mebius" class="noteref" epub:type="noteref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* 1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is </font><font style="vertical-align: inherit;">a generalized form that includes division in the transformation on the complex plane </font><font style="vertical-align: inherit;">.</font></font></p>
<div class="footnote" epub:type="footnote" id="fn-mebius"><p class="footnote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[* 1] It is derived from the mathematician August Ferdinand Mobius, who is familiar with Mobius strip.</font></font></p></div>
<div class="equation">
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z \ rightarrow \ dfrac {az + b} {cz + d}
</font></font></font></font></pre>
</div>
<p><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a, b, c, d</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> are all complex numbers.</font></font></p>

<h2><a id="h2-3"></a><span class="secno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.3　</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schottky group, Kleinian group</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consider creating a fractal figure by repeatedly using the Mobius transformations.</font></font></p>
<p><font style="vertical-align: inherit;"><span class="equation"><font style="vertical-align: inherit;">Prepare</font></span><font style="vertical-align: inherit;"> four sets of circles </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D_A</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D_a</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D_B</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D_b</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that </font><font style="vertical-align: inherit;">do not intersect each other </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">First of which focuses on two sets of circle </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D_A</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> the outside of </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D_a</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> inside, </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D_A</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> the inside of </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D_a</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mobius transformation transferred to outside </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> create a. </font><font style="vertical-align: inherit;">Similarly, </font><font style="vertical-align: inherit;">make a </font><font style="vertical-align: inherit;">Mobius transformation </font><span class="equation"><font style="vertical-align: inherit;">b</font></span><font style="vertical-align: inherit;"> from </font><font style="vertical-align: inherit;">two other sets of circles </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D_B</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D_b</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Also </font><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">prepare </font><font style="vertical-align: inherit;">the inverse transformations </font><span class="equation"><font style="vertical-align: inherit;">A</font></span><font style="vertical-align: inherit;"> and </font><span class="equation"><font style="vertical-align: inherit;">B</font></span><font style="vertical-align: inherit;"> respectively </font><font style="vertical-align: inherit;">.</font></font><span class="equation"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font><span class="equation"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font><span class="equation"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font></p>
<div id="id_fuqunaga_2Fschottky" class="image">
<img src="./Chapter 2 _ Limit sets of Kleinian groups_files/schottky.png" alt="">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 2.5: 
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The </font><font style="vertical-align: inherit;">entire transformation (for example, </font><span class="equation"><font style="vertical-align: inherit;">aaBAbbaB</font></span><font style="vertical-align: inherit;"> ) obtained by </font><font style="vertical-align: inherit;">synthesizing </font><font style="vertical-align: inherit;">the four Mobius transformations </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in any order </font><font style="vertical-align: inherit;">is called " </font><strong><font style="vertical-align: inherit;">Schottky group </font></strong><a id="fnb-Schottky" href="https://freder.io/files/unity4/fuqunaga.html#fn-Schottky" class="noteref" epub:type="noteref"><font style="vertical-align: inherit;">* 2</font></a><font style="vertical-align: inherit;"> based on </font><span class="equation"><font style="vertical-align: inherit;">a</font></span><font style="vertical-align: inherit;"> , </font><span class="equation"><font style="vertical-align: inherit;">b</font></span><font style="vertical-align: inherit;"> ".</font></font><span class="equation"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font><span class="equation"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font><span class="equation"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"></font></strong><a id="fnb-Schottky" href="https://freder.io/files/unity4/fuqunaga.html#fn-Schottky" class="noteref" epub:type="noteref"><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font></p>
<div class="footnote" epub:type="footnote" id="fn-Schottky"><p class="footnote"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[* 2] It is derived from the mathematician Friedrich Hermann Schottky who first devised such a group.</font></font></p></div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is further generalized, and the discrete group consisting of Mobius transformations </font><font style="vertical-align: inherit;">is called the </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kleinian group</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">I have the impression that this name is more widely used.</font></font></p>

<h2><a id="h2-4"></a><span class="secno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.4　</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Limit set</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When you display the image of the Schottky group, you will see a circle inside the circle, a circle inside it, and so on. </font><font style="vertical-align: inherit;">These sets are </font><font style="vertical-align: inherit;">called " </font><font style="vertical-align: inherit;">the </font><strong><font style="vertical-align: inherit;">limit set</font></strong><font style="vertical-align: inherit;"> of Schottky groups in </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font><font style="vertical-align: inherit;">The </font><font style="vertical-align: inherit;">purpose of this chapter is to draw </font><font style="vertical-align: inherit;">this </font><strong><font style="vertical-align: inherit;">limit set</font></strong><font style="vertical-align: inherit;"> .</font></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font><strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"></font></p>

<h2><a id="h2-5"></a><span class="secno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.5　</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jos Leys' algorithm</font></font></h2>

<h3><a id="h2-5-1"></a><span class="secno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.5.1　</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Overview</font></font></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I will introduce how to draw the limit set with a shader. </font><font style="vertical-align: inherit;">It is difficult to implement it honestly because the combination of conversions continues infinitely, but Jos Lays has published an algorithm for this </font></font><a id="fnb-josleys" href="https://freder.io/files/unity4/fuqunaga.html#fn-josleys" class="noteref" epub:type="noteref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* 5,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> so I will try to follow it.</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">First, prepare two Mobius transformations.</font></font></p>
<div class="equation">
<pre>a: z\rightarrow \dfrac {tz-i}{-iz}
</pre>
</div>
<div class="equation">
<pre>b: z\rightarrow z+2
</pre>
</div>
<p><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the complex number </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u + iv</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The shape of the figure can be changed by changing this value as a parameter.</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If </font><font style="vertical-align: inherit;">you take a closer look at </font><font style="vertical-align: inherit;">transformation </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ,</font></font></p>
<div class="equation">
<pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a: z \ rightarrow \ dfrac {tz-i} {- iz} = \ dfrac {t} {- i} + \ dfrac {1} {z} = \ dfrac {1} {z} + (- v + iu )
</font></font></font></font></pre>
</div>
<div class="equation">
<pre>\dfrac {1}{z}=\dfrac {1}{x+iy}=\dfrac {x-iy}{(x+iy)(x-iy)}=\dfrac {x-iy}{x^{2}+y^{2}}=\dfrac {x-iy}{\left|z\right|^{2}}
</pre>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Therefore,</font></font></p>
<div class="equation">
<pre>a: z\rightarrow \dfrac {tz-i}{-iz}=\dfrac{x-iy}{\left|z\right|^{2}}+(-v+iu)
</pre>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So</font></font></p>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Invert the circle in the unit circle,</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Invert the sign of y and</font></font></li>
<li><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-v + iu</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parallel movement</font></font></li>
</ol>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can see that it is an operation.</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The </font><font style="vertical-align: inherit;">limit set using </font><font style="vertical-align: inherit;">transformations </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and their inverse transformations is the following strip-shaped figure in which large and small circles are connected.</font></font></p>
<div id="id_fuqunaga_2Flimit__set" class="image">
<img src="./Chapter 2 _ Limit sets of Kleinian groups_files/limit_set.png" alt="Limit set">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 2.6: Limit set
</font></font></p>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's take a closer look at the features of this shape.</font></font></p>
<div id="id_fuqunaga_2Flimit__set__detail" class="image">
<img src="./Chapter 2 _ Limit sets of Kleinian groups_files/limit_set_detail.png" alt="">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Figure 2.7: 
</font></font></p>
</div>
<p><span class="equation"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It has a band shape of </font><span class="equation"><font style="vertical-align: inherit;">0 \ leq y \ leq u</font></span><font style="vertical-align: inherit;"> , and the parallelograms separated by Lines 1 and 2 repeat in the left-right direction. </font><font style="vertical-align: inherit;">Line1 is a </font><font style="vertical-align: inherit;">straight line that passes through </font><font style="vertical-align: inherit;">points </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1,0)</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and points </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1-v, u)</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and Line2 is a straight line that passes through points </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(-1,0)</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and points </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(-1-v, u)</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Line3 becomes a line that divides the figure into the upper limit, and the upper and lower figures divided by this line in the parallelogram </font><font style="vertical-align: inherit;">are point symmetric at the </font><font style="vertical-align: inherit;">point </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z =-\ dfrac {v} {2} + \ dfrac {iu} {2}</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It has become.</font></font></p>

<h3><a id="h2-5-2"></a><span class="secno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.5.2　</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Algorithm</font></font></h3>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Determines if any point is included in the limit set. </font><font style="vertical-align: inherit;">Utilizing the fact that parallelogram regions repeat on the left and right, and point symmetry on the top and bottom with Line 3 as the boundary, the judgment at each point is finally brought to the judgment of the figure in the lower half of the center. ..</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We will process a certain point as follows.</font></font></p>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If it is to the right of Line 1, move it to the left to fit within the parallelogram range</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If it's to the left of Line2, move to the right as well</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If it is above Line3, use the point symmetry and move it to the target point so that it is below Line3.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apply transformation </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font><font style="vertical-align: inherit;">points below Line3</font></font></li>
</ul>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The largest circle tangent to the </font><font style="vertical-align: inherit;">straight line </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y = 0</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the </font><font style="vertical-align: inherit;">inverted </font><font style="vertical-align: inherit;">line </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y = u</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the unit circle. </font><font style="vertical-align: inherit;">When the conversion </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is applied to </font><font style="vertical-align: inherit;">the points in this, </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y &lt;0 and</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> it </font><font style="vertical-align: inherit;">deviates from the band of </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 \ leq y \ leq u</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Therefore,</font></font></p>
<blockquote><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When a point is multiplied by the transformation </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y &lt;0</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = A point is included in this largest circle = It is included in the limit set</font></font></p></blockquote>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Judgment is made as.</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the contrary, what if it is not included? </font><font style="vertical-align: inherit;">Even if the above procedure is repeated, </font><font style="vertical-align: inherit;">the band of </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 \ leq y \ leq u</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cannot be removed, and finally the movement of two points across Line 3 will be repeated. </font><font style="vertical-align: inherit;">Therefore, if the points are the same as two points before, it can be judged that the points are not included in the limit set.</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In summary, it will be processed as follows.</font></font></p>
<ol>
<li><span class="equation"><font style="vertical-align: inherit;"></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Out of range if </font><span class="equation"><font style="vertical-align: inherit;">y &lt;0</font></span><font style="vertical-align: inherit;"> , </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u &lt;y</font></font></span><font style="vertical-align: inherit;"></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Move to the center parallelogram if it is to the right of Line1 and to the left of Line2</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Invert about center point if above Line 3</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apply </font><font style="vertical-align: inherit;">transformation </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y &lt;0,</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> it is judged as the limit set</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If it is the same as the previous point, it is judged that it is not the limit set</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If neither, go back to 2.</font></font></li>
</ol>

<h2><a id="h2-6"></a><span class="secno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.6　</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Implementation</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's take a look at the code.</font></font></p>
<div class="emlist-code">
<p class="caption">KleinianGroup.cs</p>
<pre class="emlist">private void OnRenderImage(RenderTexture source, RenderTexture destination)<font></font>
{<font></font>
    material.SetColor("_HitColor", hitColor);<font></font>
    material.SetColor("_BackColor", backColor);<font></font>
    material.SetInt("_Iteration", iteration);<font></font>
    material.SetFloat("_Scale", scale);<font></font>
    material.SetVector("_Offset", offset);<font></font>
    material.SetVector("_Circle", circle);<font></font>
<font></font>
    Vector2 uv = kleinUV;<font></font>
    if ( useUVAnimation)<font></font>
    {<font></font>
        uv = new Vector2(<font></font>
            animKleinU.Evaluate(time),<font></font>
            animKleinV.Evaluate(time)<font></font>
            );<font></font>
    }<font></font>
    material.SetVector("_KleinUV", uv);<font></font>
    Graphics.Blit(source, destination, material, pass);<font></font>
}<font></font>
</pre>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the C # side, it is </font></font><code class="inline-code tt">OnRenderImage()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">only a process </font><font style="vertical-align: inherit;">to draw the material while passing the parameters set in the inspector in KleinianGroup.cs </font><font style="vertical-align: inherit;">.</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's take a look at the shader.</font></font></p>
<div class="emlist-code">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KleinianGroup.shader</font></font></font></font></p>
<pre class="emlist">#pragma vertex vert_img
</pre>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The Vertex shader uses Unity standard vert_img. </font><font style="vertical-align: inherit;">The main is the Fragment shader. </font><font style="vertical-align: inherit;">There are 3 Fragment shaders, each with a different path. </font><font style="vertical-align: inherit;">The first is the standard one, the second is the one with the blurring process and the appearance is a little cleaner, and the third is the one with the further circle inversion described later. </font><font style="vertical-align: inherit;">You can now choose which path to use in KleinianGroup.cs. </font><font style="vertical-align: inherit;">Let's look at the first one here.</font></font></p>
<div class="emlist-code">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KleinianGroup.shader</font></font></font></font></p>
<pre class="emlist">fixed4 frag (v2f_img i) : SV_Target<font></font>
{<font></font>
    float2 pos = i.uv;<font></font>
    float aspect = _ScreenParams.x / _ScreenParams.y;<font></font>
    pos.x *= aspect;<font></font>
    pos += _Offset;<font></font>
    pos *= _Scale;<font></font>
<font></font>
    bool hit = josKleinian(pos, _KleinUV);<font></font>
    return hit ? _HitColor : _BackColor;<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font></font></font><font></font>
</pre>
</div>
<p><code class="inline-code tt">_ScreenParams</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The aspect ratio is calculated from and multiplied by pos.x. </font><font style="vertical-align: inherit;">Now the area on the screen represented by pos is 0 ≤ y ≤ 1, and x is the range according to the aspect ratio. </font><font style="vertical-align: inherit;">Furthermore </font><font style="vertical-align: inherit;">, the position and range to be displayed can be adjusted by applying </font></font><code class="inline-code tt">_Offset</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">passed from the C # side </font></font><code class="inline-code tt">_Scale</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><code class="inline-code tt">josKleinian()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The color to be output is determined by judging whether or not the limit set is possible.</font></font></p>
<p><code class="inline-code tt">josKleinian()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's take a closer look.</font></font></p>
<div class="emlist-code">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KleinianGroup.shader</font></font></p>
<pre class="emlist">bool josKleinian(float2 z, float2 t)<font></font>
{<font></font>
    float u = t.x;<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    float v = ty;</font></font><font></font>
<font></font>
    float2 lz=z+(1).xx;<font></font>
    float2 llz=z+(-1).xx;<font></font>
<font></font>
    for (uint i = 0; i &lt; _Iteration ; i++)<font></font>
    {<font></font>
        ～<font></font>
</pre>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A function that receives the point z and the Mobius transformation parameter t and determines whether z is included in the limit set. </font><font style="vertical-align: inherit;">lz and llz are variables for judging "the same point as before" indicating that they are outside the set. </font><font style="vertical-align: inherit;">For the time being, the values ​​are initialized so that they are different from z at the start and also different from each other. </font></font><code class="inline-code tt">_Iteration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Is the maximum number of times to repeat the procedure. </font><font style="vertical-align: inherit;">I think that it is enough that the value is not so large unless you look at the details in a magnified manner.</font></font></p>
<div class="emlist-code">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KleinianGroup.shader</font></font></font></font></p>
<pre class="emlist">// wrap if outside of Line1,2<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
float offset_x = abs (v) / u * zy;</font></font></font></font><font></font>
z.x += offset_x;<font></font>
z.x = wrap(z.x, 2, -1);<font></font>
z.x -= offset_x;<font></font>
</pre>
</div>
<div class="emlist-code">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KleinianGroup.shader</font></font></font></font></p>
<pre class="emlist">float wrap(float x, float width, float left_side){<font></font>
    x -= left_side;<font></font>
    return (x - width * floor(x/width)) + left_side;<font></font>
}<font></font>
</pre>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is</font></font></p>
<blockquote><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Move to the center parallelogram if it is to the right of Line1 and to the left of Line2</font></font></font></font></p></blockquote>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It will be the part of.</font></font></p>
<p><code class="inline-code tt">wrap()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Is a function that receives the position of the point, the width of the rectangle, and the coordinates of the left edge of the rectangle, and stores the points that extend to the left and right. </font><font style="vertical-align: inherit;">It is a process to convert a parallelogram to a rectangle with </font></font><code class="inline-code tt">wrap()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">offset_x, put it within the range with offset_x, and return it to a parallelogram again with offset_x.</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next is the judgment of Line3.</font></font></p>
<div class="emlist-code">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KleinianGroup.shader</font></font></font></font></p>
<pre class="emlist">//if above Line3, inverse at (-v/2, u/2)<font></font>
float separate_line = u * 0.5<font></font>
    + sign(v) *(2 * u - 1.95) / 4 * sign(z.x + v * 0.5)<font></font>
    * (1 - exp(-(7.2 - (1.95 - u) * 15)* abs(z.x + v * 0.5)));<font></font>
<font></font>
if  (z.y &gt;= separate_line)<font></font>
{<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    z = float2 (-v, u) - z;</font></font></font></font><font></font>
}<font></font>
</pre>
</div>
<p><code class="inline-code tt">separate_line</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The part that asks for is the conditional expression of Line3. </font><font style="vertical-align: inherit;">I don't know how to derive this part, and I think it is roughly calculated from the symmetry of the figure. </font><font style="vertical-align: inherit;">Depending on the value of t that has been squeezed into a complicated figure, the upper and lower figures may mesh with each other in a jagged manner, and this conditional expression may not be sufficient to divide it properly, but this time it is effective in a general form. Will be used as it is.</font></font></p>
<div class="emlist-code">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KleinianGroup.shader</font></font></font></font></p>
<pre class="emlist"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z = TransA (z, t);
</font></font></font></font></pre>
</div>
<div class="emlist-code">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KleinianGroup.shader</font></font></font></font></p>
<pre class="emlist">float2 TransA(float2 z, float2 t){<font></font>
    return float2(z.x, -z.y) / dot(z,z) + float2(-t.y, t.x);<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font></font></font><font></font>
</pre>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finally </font><font style="vertical-align: inherit;">, apply the </font><font style="vertical-align: inherit;">Mobius transformation </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to the </font><font style="vertical-align: inherit;">point z </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Using the above formula transformation to make it easier to code,</font></font></p>
<div class="equation">
<pre>a: z\rightarrow \dfrac {tz-i}{-iz}=\dfrac{x-iy}{\left|z\right|^{2}}+(-v+iu)
</pre>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I'm implementing this.</font></font></p>
<div class="emlist-code">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KleinianGroup.shader</font></font></font></font></p>
<pre class="emlist">//hit!<font></font>
if (z.y&lt;0) { return true; }<font></font>
</pre>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a result of conversion, </font><font style="vertical-align: inherit;">if </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y &lt;0,</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> limit set judgment,</font></font></p>
<div class="emlist-code">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KleinianGroup.shader</font></font></font></font></p>
<pre class="emlist">//2cycle<font></font>
if(length(z-llz) &lt; 1e-6) {break;}<font></font>
<font></font>
llz=lz;<font></font>
lz=z;<font></font>
</pre>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If the value is almost the same as the point two points before, it is judged that it is not the limit set. </font><font style="vertical-align: inherit;">Also, </font></font><code class="inline-code tt">_Iteration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if the judgment result is not obtained even if it is repeated, it is judged that it is not the limit set.</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This completes the shader implementation. </font><font style="vertical-align: inherit;">The parameter t is </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(2,0)</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the most with a typical value of </font></font><span class="equation"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(1.94,0.02)</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is likely to be interesting shape in the vicinity. </font><font style="vertical-align: inherit;">The sample project can be edited in the inspector of KleinianGroupDemo.cs, so please play with it.</font></font></p>

<h2><a id="h2-7"></a><span class="secno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.7　</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Further circle inversion</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">That's all for displaying the limit set, but to make it interesting as an animation, we will add a powerful topping at the end. </font></font><code class="inline-code tt">josKleinian()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Invert the position in a circle before passing it over. </font><font style="vertical-align: inherit;">Circle inversion swaps the infinitely expanding area outside the circle with the inside, and the circle is transferred as a circle. </font><font style="vertical-align: inherit;">And the limit set is made up of innumerable circles. </font><font style="vertical-align: inherit;">By moving this inverted circle or changing the radius, you can create a mysterious appearance that you cannot predict while taking advantage of the fun of fractals.</font></font></p>
<div class="emlist-code">
<p class="caption"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KleinianGroup.shader</font></font></font></font></p>
<pre class="emlist">float4 calc_color(float2 pos)<font></font>
{<font></font>
    bool hit = josKleinian(pos, _KleinUV);<font></font>
    return hit ? _HitColor : _BackColor;<font></font>
}<font></font>
<font></font>
～<font></font>
float4 _Circle;<font></font>
<font></font>
float2 circleInverse(float2 pos, float2 center, float radius)<font></font>
{<font></font>
    float2 p = pos - center;<font></font>
    p = (p * radius) / dot(p,p);<font></font>
    p += center;<font></font>
    return p;<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font></font></font><font></font>
<font></font>
fixed4 frag_circle_inverse(v2f_img i) : SV_Target<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
{</font></font></font></font><font></font>
    float2 pos = i.uv;<font></font>
    float aspect = _ScreenParams.x / _ScreenParams.y;<font></font>
    pos.x *= aspect;<font></font>
    pos *= _Scale;<font></font>
    pos += _Offset;<font></font>
<font></font>
    int sample_num = 10;<font></font>
    float4 sum;<font></font>
    for (int i = 0; i &lt; sample_num; ++i)<font></font>
    {<font></font>
        float2 offset = rand2n(pos, i) * (1/_ScreenParams.y) * 3;<font></font>
        float2 p = circleInverse(pos + offset, _Circle.xy, _Circle.w);<font></font>
        sum += calc_color(p);<font></font>
    }<font></font>
<font></font>
    return sum / sample_num;<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
}</font></font></font></font><font></font>
</pre>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is a Fragment shader with the circular inversion defined in the third path. </font></font><code class="inline-code tt">sample_num</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The loop of is a process to make the appearance beautiful by calculating the surrounding pixels and blurring it a little. </font></font><code class="inline-code tt">calc_color()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, it is the process of calculating the color so far, </font></font><code class="inline-code tt">ciecleInverse()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and the circle is inverted </font><font style="vertical-align: inherit;">before that </font><font style="vertical-align: inherit;">.</font></font></p>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the KleinianGroupCircleInverse scene, fractal-like animation works by changing the parameters of this shader with Animator.</font></font></p>

<h2><a id="h2-8"></a><span class="secno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.8　</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Summary</font></font></h2>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this chapter, we introduced how to draw the limit set of Kleinian groups with a shader and how to make more interesting fractal figures by using circle inversion. </font><font style="vertical-align: inherit;">Fractal and Mobius transformations were difficult to get to in fields that I wasn't familiar with, but it was very exciting to see unexpected patterns moving one after another. </font><font style="vertical-align: inherit;">If you like, please try it out!</font></font></p>

<h2><a id="h2-9"></a><span class="secno"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2.9　</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Reference</font></font></h2>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indra's pearl </font></font><a id="fnb-indra" href="https://freder.io/files/unity4/fuqunaga.html#fn-indra" class="noteref" epub:type="noteref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* 3 The</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> strongest bible. </font><font style="vertical-align: inherit;">It's a little pricey and the content is advanced, so if you want to understand more deeply by looking at the following, it is recommended to pick it up.</font></font></li>
</ul>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mathe Vital </font></font><a id="fnb-mathevital" href="https://freder.io/files/unity4/fuqunaga.html#fn-mathevital" class="noteref" epub:type="noteref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* 4</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Indra's pearl essence is extracted and introduced in an easy-to-understand manner. </font><font style="vertical-align: inherit;">I think it's a good idea to start from here.</font></font></li>
</ul>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jos Leys' algorithm introduced this time </font></font><a id="fnb-josleys" href="https://freder.io/files/unity4/fuqunaga.html#fn-josleys" class="noteref" epub:type="noteref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* 5</font></font></a></li>
</ul>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jos Leys' Shadertoy </font></font><a id="fnb-jos_shadertoy" href="https://freder.io/files/unity4/fuqunaga.html#fn-jos_shadertoy" class="noteref" epub:type="noteref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* 6</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> An example of a valuable shader implementation</font></font></li>
</ul>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Morph </font></font><a id="fnb-morph" href="https://freder.io/files/unity4/fuqunaga.html#fn-morph" class="noteref" epub:type="noteref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* 7</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> @soma_arc </font></font><a id="fnb-soma" href="https://freder.io/files/unity4/fuqunaga.html#fn-soma" class="noteref" epub:type="noteref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* 8</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> was </font><font style="vertical-align: inherit;">announced at </font><font style="vertical-align: inherit;">TokyoDemoFest2018 </font></font><a id="fnb-tdf" href="https://freder.io/files/unity4/fuqunaga.html#fn-tdf" class="noteref" epub:type="noteref"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* 9</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">This time, it was an opportunity for me to learn the Kleinian group myself. </font><font style="vertical-align: inherit;">This is also a valuable shader implementation example.</font></font></li>
</ul>
<div class="footnote" epub:type="footnote" id="fn-indra"><p class="footnote">[*3] https://www.amazon.co.jp/dp/4535783616</p></div>
<div class="footnote" epub:type="footnote" id="fn-mathevital"><p class="footnote">[*4] http://userweb.pep.ne.jp/hannyalab/MatheVital/IndrasPearls/IndrasPearlsindex.html</p></div>
<div class="footnote" epub:type="footnote" id="fn-josleys"><p class="footnote">[*5] http://www.josleys.com/articles/Kleinian%20escape-time_3.pdf</p></div>
<div class="footnote" epub:type="footnote" id="fn-jos_shadertoy"><p class="footnote">[*6] https://www.shadertoy.com/user/JosLeys</p></div>
<div class="footnote" epub:type="footnote" id="fn-morph"><p class="footnote">[*7] https://www.shadertoy.com/view/MlGfDG</p></div>
<div class="footnote" epub:type="footnote" id="fn-soma"><p class="footnote">[*8] https://twitter.com/soma_arc</p></div>
<div class="footnote" epub:type="footnote" id="fn-tdf"><p class="footnote">[*9] http://tokyodemofest.jp/2018/</p></div><div id="goog-gt-tt" class="goog-tooltip skiptranslate" dir="ltr" style="visibility: hidden; left: 557px; top: 39.125px; display: none;"><div style="padding: 8px;"><div><div class="logo"><img src="./Chapter 2 _ Limit sets of Kleinian groups_files/translate_24dp.png" width="20" height="20" alt="Google Translate"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">Original text</h1></div><div class="middle" style="padding: 8px;"><div class="original-text">第2章　Limit sets of Kleinian groups</div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">Contribute a better translation</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none; opacity: 0;"></div></div>


<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div><iframe frameborder="0" class="goog-te-menu-frame skiptranslate" title="Language Translate Widget" style="visibility: visible; box-sizing: content-box; width: 1001px; height: 263px; display: none;" src="./Chapter 2 _ Limit sets of Kleinian groups_files/saved_resource(1).html"></iframe><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="https://www.gstatic.com/images/branding/product/1x/translate_24dp.png" width="20" height="20" alt="Google Translate"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">Original text</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">Contribute a better translation</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div><iframe frameborder="0" class="goog-te-menu-frame skiptranslate" title="Language Translate Widget" style="visibility: visible; box-sizing: content-box; width: 197px; height: 69px; display: none;" src="./Chapter 2 _ Limit sets of Kleinian groups_files/saved_resource(2).html"></iframe><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="https://www.gstatic.com/images/branding/product/1x/translate_24dp.png" width="20" height="20" alt="Google Translate"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">Original text</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">Contribute a better translation</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div><div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="https://www.gstatic.com/images/branding/product/1x/translate_24dp.png" width="20" height="20" alt="Google Translate"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">Original text</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">Contribute a better translation</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div><div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div><div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div><iframe frameborder="0" class="goog-te-menu-frame skiptranslate" title="Language Translate Widget" style="visibility: visible; box-sizing: content-box; width: 1001px; height: 263px; display: none;"></iframe><iframe frameborder="0" class="goog-te-menu-frame skiptranslate" title="Language Translate Widget" style="visibility: visible; box-sizing: content-box; width: 197px; height: 69px; display: none;"></iframe><iframe frameborder="0" class="goog-te-menu-frame skiptranslate" title="Language Translate Widget" style="visibility: visible; box-sizing: content-box; width: 1001px; height: 263px; display: none;"></iframe><iframe frameborder="0" class="goog-te-menu-frame skiptranslate" title="Language Translate Widget" style="visibility: visible; box-sizing: content-box; width: 197px; height: 69px; display: none;"></iframe></body></html>